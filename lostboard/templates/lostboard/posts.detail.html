{% extends 'base/base.html' %}

{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'base/css/board.css' %}">
    <link rel="stylesheet" href="{% static 'lostboard/css/posts.detail.css' %}">
{% endblock %}

{% block contents %}

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<div class="boardBody fontClass2">
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'info' %}
                <div class="alert alert-success alert-dismissible">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    {{ message }} 
                </div>
            {% else %}
                <div class="alert alert-danger alert-dismissible">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    {{ message }} 
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
    <div class="board-header">
        <p class="title">분실물</p>
        <a href="javascript:history.back()">뒤로가기</a>
    </div>
    <div class="boards detail-container">
        <div class="board-detail">
            <div class="detail-header">
                {% if found is True %}
                <p>주웠어요</p>
                {% else %}
                <p>잃어버렸어요</p>
                {% endif %}
                <div class="buttons">
                    <button id="cmtBtn" onclick="show_add_comment_modal(event, '{{post.pk}}')" class="btn-addcmt"></button>
                    <button id="delBtn" onclick="show_delete_post_modal(event)"></button>
                </div>
            </div>
            <div class="detail-content">
                <div style="word-break:break-all">{{content|linebreaks}}</div>
                <br>
            </div>
            {% if image %}
                <img src="{{ image }}" alt="">
            {% endif %}
            <div class="detail-footer">
                <p class="footerArea">{{post.created_at}}</p>
                <p class="footerArea">댓글 {{ comments.count }}개</p>
            </div>
        </div>
        <hr>

        <div class="board-detail-comments lostboard"></div>

        <div class="modal posts-delete">
            <form action="{{url}}" method="POST">
                {% csrf_token %}
                {% include 'forms/delete.html' %}
                <div class="modal-content delete-body">
                    <div class="delete-header">
                        <p>삭제하기</p>
                        <span class="close" id="delcls{{post.pk}}">&times;</span>     
                    </div>                                                          
                    <p>글 등록시 입력 한 비밀번호 입력하세요</p>
                    <input name="password" type="password">
                    <button type="submit" class="btn btn-danger">삭제</button>
                </div>
            </form>
        </div>
        <div class="modal posts-comments-create">
            <form action="{{ comments }}" method="POST">
                {% csrf_token %}
                <div class="modal-content addcmt-body">
                    <div class="addcmt-header">
                        <p>댓글 작성</p>
                        <span class="close" id="cmtcls{{post.pk}}">&times;</span>     
                    </div>                                                          
                    <textarea name="content" cols="40" rows="10" class="form-control" required="" id="id_content"></textarea>
                    <input type="password" name="password" maxlength="200" required="" id="id_password" placeholder="패스워드를 입력하세요">
                    <button type="submit" class="btn btn-primary">확인</button>
                </div>
            </form>
        </div> 
        <div class="modal comments-comments-create">
            <form action="" method="POST">
                {% csrf_token %}
                <div class="modal-content addcmt-body">
                    <div class="addcmt-header">
                        <p>댓글 작성</p>
                        <span class="close" id="cmtcls{{post.pk}}">&times;</span>     
                    </div>                                                          
                    <textarea name="content" cols="40" rows="10" class="form-control" required="" id="id_content"></textarea>
                    <input type="password" name="password" maxlength="200" required="" id="id_password" placeholder="패스워드를 입력하세요">
                    <button type="submit" class="btn btn-primary">확인</button>
                </div>
            </form>
        </div> 
        <div class="modal comments-delete">
            <form action="" method="POST">
                {% csrf_token %}
                {% include 'forms/delete.html' %}
                <div class="modal-content delete-body">
                    <div class="delete-header">
                        <p>삭제하기</p>
                        <span class="close" id="delcls{{post.pk}}">&times;</span>     
                    </div>                                                          
                    <p>글 등록시 입력 한 비밀번호 입력하세요</p>
                    <input name="password" type="password">
                    <button type="submit" class="btn btn-danger">삭제</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}


{% block js %}
<script src="{% static 'lostboard/js/posts.detail.js' %}"></script>
<script src="{% static 'lostboard/js/posts/comments.list.js' %}"></script>
<script src="{% static 'lostboard/js/comments/comments.list.js' %}"></script> 
<script src="{% static 'lostboard/js/comments.detail.js' %}"></script>
<script>
window.onload = async function() {
    posts_comments_list("{{ comments.url }}.json")
}
</script>
{% endblock %}
